<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>採点基準の設定</title>
    {% load static %} <!-- static タグをロード -->
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <style>
        .quecounter-input {
            font-size: 30px;
            text-align: right;
            width: 100px;
            margin: 20px;
        }

        .scorecounter-input,
        .partialscore-input {
            font-size: 30px;
            text-align: center;
            width: 100px;
            margin: 20px;
        }

        .main-content-individual-markset-container {
            flex: 1;
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: #f9f9f9;
        }

        .marksetcontainer {
            display: flex;
            min-height: 100vh;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        table,
        th,
        td {
            border: 1px solid black;
        }

        th,
        td {
            padding: 8px;
            text-align: center;
        }

        .counter-wrapper {
            display: flex;
            align-items: center;
        }

        .counter-wrapper span {
            font-size: 30px;
            margin-left: 10px;
        }

        input[type="number"] {
            font-size: 30px;
            text-align: center;
            width: 100px;
        }
    </style>

    <script>
        let quenumber = 0;

        function queupdateCounter() {
            document.getElementById("quecounter").value = quenumber;
        }

        function queincrease() {
            quenumber++;
            queupdateCounter();
            updateTable(); // テーブル更新
        }

        function quedecrease() {
            if (quenumber > 0) {
                quenumber--;
                queupdateCounter();
                updateTable(); // テーブル更新
            }
        }

        let scorenumber = 0;

        function scoreupdateCounter() {
            document.getElementById("scorecounter").value = scorenumber;
        }

        function scoreincrease() {
            scorenumber++;
            scoreupdateCounter();
        }

        function scoredecrease() {
            if (scorenumber > 0) {
                scorenumber--;
                scoreupdateCounter();
            }
        }

        function updateTable() {
            const tbody = document.getElementById('marksetTable').getElementsByTagName('tbody')[0];
            tbody.innerHTML = ''; // tbodyをクリア

            for (let i = 0; i < quenumber; i++) {
                const row = document.createElement('tr');
                // 問題列
                const questionCell = document.createElement('td');
                questionCell.textContent = `問題${i + 1}`;
                row.appendChild(questionCell);

                // 点数列：常に0を表示
                const scoreCell = document.createElement('td');
                scoreCell.textContent = '0'; // 常に0を表示
                const scoreSpan = document.createElement('span');
                scoreSpan.textContent = '点'; // 常に「点」を表示
                scoreCell.appendChild(scoreSpan);
                row.appendChild(scoreCell);

                // 部分点列：inputフィールドを追加
                const partialScoreCell = document.createElement('td');
                const partialScoreInput = document.createElement('input');
                partialScoreInput.type = 'number';
                partialScoreInput.value = 0; // 部分点は初期0
                partialScoreInput.min = 0; // 部分点は0以上
                partialScoreCell.appendChild(partialScoreInput);
                const partialScoreSpan = document.createElement('span');
                partialScoreSpan.textContent = '点'; // 常に「点」を表示
                partialScoreCell.appendChild(partialScoreSpan);
                row.appendChild(partialScoreCell);

                tbody.appendChild(row);
            }
        }

        // 初期設定でテーブルを表示
        document.addEventListener('DOMContentLoaded', () => {
            queupdateCounter(); // 初期状態をセット
            scoreupdateCounter(); // 初期状態をセット
        });
    </script>

</head>

<body>
    <div class="marksetcontainer">
        {% include 'KDPS/menu.html' %} <!-- サイドバーの読み込み -->
        <div class="main-content-individual-markset-container">
            <h1>自動採点</h1>

            <h3>問題数を入力してください</h3>
            <div class="counter-wrapper">
                <button onclick="quedecrease()">-</button>
                <input type="number" class="quecounter-input" min="1" id="quecounter" value="0">
                <span>問</span> <!-- 常に「問」を表示 -->
                <button onclick="queincrease()">+</button>
            </div>

            <h3>満点になる点数を入力してください</h3>
            <div class="counter-wrapper">
                <button onclick="scoredecrease()">-</button>
                <input type="number" class="scorecounter-input" min="1" id="scorecounter" value="0">
                <span>点</span> <!-- 常に「点」を表示 -->
                <button onclick="scoreincrease()">+</button>
            </div>

            <table id="marksetTable">
                <thead>
                    <tr>
                        <th>問題数</th>
                        <th>点数</th>
                        <th>部分点</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- 行が動的に追加されます -->
                </tbody>
            </table>

            <button type="submit">登録</button>
        </div>
    </div>
</body>

</html>
