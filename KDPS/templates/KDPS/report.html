<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>個人成績レポート</title>
</head>
<body>
    <h2>個人成績レポート</h2>

    <form method="POST" action="{% url 'report' %}">
        {% csrf_token %}
        <label for="student_id">生徒を選択:</label>
        <select name="student_id" id="student_id">
            {% for student in students %}
                <option value="{{ student.student_id }}">{{ student.student_name }}</option>
            {% endfor %}
        </select>

        <label for="test_id">試験を選択:</label>
        <select name="test_id" id="test_id">
            {% for test in tests %}
                <option value="{{ test.test_id }}">{{ test.test_name }}</option>
            {% endfor %}
        </select>

        <label for="score">点数:</label>
        <input type="number" name="score" id="score" required>

        <button type="submit">成績を追加</button>
    </form>

    <h3>成績一覧</h3>
    <table>
        <thead>
            <tr>
                <th>生徒名</th>
                <th>試験名</th>
                <th>点数</th>
            </tr>
        </thead>
        <tbody>
            {% for grade in grades %}
                <tr>
                    <td>{{ grade.student.student_name }}</td>
                    <td>{{ grade.test.test_name }}</td>
                    <td>{{ grade.score }}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <form method="POST" action="{% url 'send_report' %}">
        {% csrf_token %}
        <label for="student_id_to_send">保護者に送信する生徒:</label>
        <select name="student_id" id="student_id_to_send">
            {% for student in students %}
                <option value="{{ student.student_id }}">{{ student.student_name }}</option>
            {% endfor %}
        </select>
        <button type="submit">保護者に送信</button>
    </form>

    {% if messages %}
        {% for message in messages %}
            <p>{{ message }}</p>
        {% endfor %}
    {% endif %}
</body>
</html>
